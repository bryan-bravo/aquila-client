import { Component, OnInit } from '@angular/core';
import {  Router }   from '@angular/router';
import {PreawardService} from '../../services/preaward.service';
import {MenuItem,Header} from 'primeng/primeng';
import {ProjectInfo} from '../../models/ProjectInfo';
import {User} from '../../models/User';
import { isNgTemplate } from '@angular/compiler';
import { paramKey } from 'blocking-proxy/built/lib/webdriver_commands';

@Component({
  selector: 'app-pihome-page',
  templateUrl: './pihome-page.component.html',
  styleUrls: ['./pihome-page.component.css']
})
export class PiHomePageComponent implements OnInit {
  user:User;
  name:string;
  newProposalName:string;
  items: MenuItem[];
  projects: ProjectInfo[];
  constructor(private router:Router,private preAwardService:PreawardService) { }

  ngOnInit() {
    this.populateMenuBar();
    this.populateProjects();
  }
  populateMenuBar(){
    this.name ='Bryan';
    this.items=[ 
      {
       label:'Welcome '+this.name+',' 
      },
      {
        label: 'Settings',
        icon: 'fa-gear',
        //edit user settings,
        items: [
          {
            label:'Edit Information',
            command:this.editInformationClicked
          }
        ]
      }
    ];
  }
  populateProjects(){
    this.projects =[];    
    let dummyProject = {
      'name':'Beds In The Library',
      'date':'Jan 18, 2013 - current',
      'status':'PreAward',
      'id':3242342
    };
    this.projects.push(dummyProject);
    
  }
  editInformationClicked(){
//username,firstname, lastname, ctact email, phone number, 
//have these fields bind to the component, call a service, response perhaps change the user in sessionScope
}
newProposalNameSubmitted(){ 
  
  let idFromResponse ='qwerty';
  this.preAwardService.newProposal(this.newProposalName).subscribe(proposal=>{
    this.router.navigate(['editproposal/'+proposal.id]);
  });

}

}
 ------------------------------------
 <div class='container'>
    <p-menubar [model]='items'>
        <button pButton class='ui-button-warning' type='button' label='New Proposal' (click)="op.show($event)"></button>
    </p-menubar>
</div>
<p-overlayPanel #op>
    <form (ngSubmit)='newProposalNameSubmitted()'>
        <span class="ui-float-label">
        <input id="nop" type="text" size="30" pInputText name="newProposalName" [(ngModel)]='newProposalName' /> 
        <label for="nop">Name of Project</label>        
        </span>
        <button pButton class='ui-button-success' type='submit' label='Submit' (click)="op.hide($event)"></button>
    </form>
</p-overlayPanel>

<div class='container'>
    <p-dataList [value]="projects">
        <p-header>My Projects</p-header>
        <ng-template let-project pTemplate="item">
            <div class='projectRow'>
                <p class='projectdescription'><a href=''>{{project.name}}</a></p>
                <p class='projectdescription'> {{project.date}} </p>
                <p class='projectdescription'> {{project.status}} </p>
            </div>
        </ng-template>
    </p-dataList>
</div>